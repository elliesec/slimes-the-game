{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/classnames/index.js","webpack:///./src/combat-sandbox-1/assets/mimic.jpg","webpack:///./src/common/redux/encounter/encounterActions.ts","webpack:///./src/combat-sandbox-1/enums.ts","webpack:///./src/combat-sandbox-1/redux/actions/game-actions.ts","webpack:///./src/common/functions.ts","webpack:///./src/common/math/mathUtils.ts","webpack:///./src/combat-sandbox-1/components/encounter/EncounterSelection.tsx","webpack:///./src/combat-sandbox-1/components/encounter/EncounterStageText.tsx","webpack:///./src/common/model/encounter/EncounterStage.ts","webpack:///./src/common/model/encounter/ActiveEncounter.ts","webpack:///./src/combat-sandbox-1/Player.ts","webpack:///./src/common/encounter/encounterUtils.ts","webpack:///./src/combat-sandbox-1/components/encounter/ChoiceItemList/ChoiceItem.tsx","webpack:///./src/combat-sandbox-1/components/encounter/ChoiceItemList/ChoiceItemList.tsx","webpack:///./src/common/model/encounter/EncounterChoice.ts","webpack:///./src/combat-sandbox-1/components/encounter/choiceTypes/EndEncounterChoiceView.tsx","webpack:///./src/common/model/encounter/EncounterOutcome.ts","webpack:///./src/combat-sandbox-1/components/encounter/choiceTypes/RollChoiceView.tsx","webpack:///./src/combat-sandbox-1/components/encounter/stageTypes/PickedStateView.tsx","webpack:///./src/combat-sandbox-1/components/encounter/stageTypes/ChoicesStageView.tsx","webpack:///./src/combat-sandbox-1/components/encounter/StageTypeView.tsx","webpack:///./src/combat-sandbox-1/components/encounter/EncounterStageView.tsx","webpack:///./src/combat-sandbox-1/components/encounter/EncounterView.tsx","webpack:///./src/combat-sandbox-1/components/EncounterPanel/EncounterPanel.tsx","webpack:///./src/combat-sandbox-1/redux/actions/player-actions.ts","webpack:///./src/combat-sandbox-1/redux/reducers/player-reducer.ts","webpack:///./src/combat-sandbox-1/components/PlayerConfigPanel/PlayerConfigPanelInput.tsx","webpack:///./src/combat-sandbox-1/components/PlayerConfigPanel/PlayerConfigPanel.tsx","webpack:///./src/combat-sandbox-1/encounter1.ts","webpack:///./src/combat-sandbox-1/CombatSandbox1.tsx","webpack:///./src/common/redux/encounter/activeEncounterReducer.ts","webpack:///./src/common/redux/encounter/encounterByIdReducer.ts","webpack:///./src/common/redux/encounter/encounterReducer.ts","webpack:///./src/combat-sandbox-1/redux/reducers/current-scene-reducer.ts","webpack:///./src/combat-sandbox-1/redux/root-reducer.ts","webpack:///./src/combat-sandbox-1/redux/store.ts","webpack:///./src/combatSandbox1.tsx"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","2","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","hasOwn","classNames","classes","arguments","arg","argType","Array","isArray","inner","join","default","EncounterAction","Scene","GameActions","noop","args","dieCount","dieFaces","sum","randomInt","min","max","Math","floor","random","encounterEnd","type","END","setScene","scene","SET_SCENE","payload","props","super","this","state","selectedEncounter","onSelectChange","onSelectEncounter","encounters","className","htmlFor","id","onChange","map","encounter","disabled","onClick","e","encounterId","currentTarget","find","setState","defaultProps","EncounterSelection","values","byId","dispatch","START","encounterStart","ENCOUNTER","EncounterStageText","text","EncounterStageType","StageState","RollState","RollOutcomeType","instanceOfChoicesStage","stage","CHOICE","Stat","statNames","STR","DEX","CON","WIS","INT","CHA","statAbbreviations","getRequiredStats","requirements","keys","ChoiceItem","player","choice","fixed","onSelect","every","stat","checkChoiceRequirements","requirementsText","stats","getStatAbbreviation","description","ChoiceItemList","choices","ChoiceType","instanceofRollChoice","ROLL","EndEncounterChoiceView","ownProps","activeEncounter","active","ENCOUNTER_END","onContinue","continueText","OutcomeType","RollChoiceInitView","onRoll","rolls","canContinue","rollCost","canRoll","willpower","rollCallback","statSum","reduce","rollSum","roll","continueCallback","primary","getStatName","RollChoiceRolledView","onRolledContinue","onContinueClick","rollTotal","rollOutcomeType","rollOutcome","RollChoiceView","cost","encounterRoll","ROLL_CONTINUE","encounterRollContinue","stageId","END_ENCOUNTER","NEXT_STAGE","nextStageId","SET_STAGE","rollState","INIT","ROLLED","instanceOfEndEncounterChoice","InitStateView","onChoiceSelect","ChoicesStageView","SELECT_CHOICE","encounterSelectChoice","StateView","PICKED","getStateView","stageState","StageTypeView","StageView","EncounterStageView","mimic","EncounterView","src","alt","sceneTitles","ENCOUNTER_SELECT","EncounterPanel","currentScene","RESET","onReset","renderView","PlayerActions","setPlayer","SET_PLAYER","setStat","statName","SET_PLAYER_STAT","reducerMap","SET_PLAYER_DESCRIPTION","PlayerConfigPanelInput","label","PlayerConfigPanel","maxWillpower","strength","dexterity","constitution","wisdom","intelligence","charisma","setDescription","Number","onPlayerReset","onNameChange","onStrengthChange","onDexterityChange","onConstitutionChange","onWisdomChange","onIntelligenceChange","onCharismaChange","onMaxWillpowerChange","onWillpowerChange","encounter1","entryStage","stages","dc","outcomes","criticalSuccess","success","failure","criticalFailure","load","ConnectedCombatSandbox1","REGISTER","reducers","action","includes","newState","SET_STAGE_STATE","total","CRITICAL_SUCCESS","SUCCESS","CRITICAL_FAILURE","FAILURE","newStage","console","warn","encounterReducer","reducer","rootReducer","store","appRoot","document","getElementById"],"mappings":"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","file":"combatSandbox1.2a965b5badcec0a0dfee.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t2: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/slimes-the-game/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([80,0,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg) && arg.length) {\n\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\tif (inner) {\n\t\t\t\t\tclasses.push(inner);\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","module.exports = __webpack_public_path__ + \"assets/c627a862d41d9026b5ade2a0fda5b886.jpg\";","import { Action } from 'redux';\r\nimport { Player } from '../../../combat-sandbox-1/Player';\r\nimport { PayloadAction } from '../../../combat-sandbox-1/redux/redux-utils';\r\nimport { roll } from '../../math/mathUtils';\r\nimport { StageState } from '../../model/encounter/ActiveEncounter';\r\nimport { Encounter } from '../../model/encounter/Encounter';\r\nimport { EncounterChoice } from '../../model/encounter/EncounterChoice';\r\n\r\nexport enum EncounterAction {\r\n    REGISTER = 'ENCOUNTER_REGISTER',\r\n    START = 'ENCOUNTER_START',\r\n    RESET = 'ENCOUNTER_RESET',\r\n    SELECT_CHOICE = 'ENCOUNTER_SELECT_CHOICE',\r\n    SET_STAGE_STATE = 'ENCOUNTER_SET_STAGE_STATE',\r\n    END = 'ENCOUNTER_END',\r\n    ROLL = 'ENCOUNTER_ROLL',\r\n    ROLL_CONTINUE = 'ENCOUNTER_ROLL_CONTINUE',\r\n    SET_STAGE = 'SET_STAGE',\r\n}\r\n\r\nexport interface EncounterRollDef {\r\n    roll: number;\r\n    cost: number;\r\n}\r\n\r\nexport function encounterRegister(encounter: Encounter): PayloadAction<Encounter> {\r\n    return { type: EncounterAction.REGISTER, payload: encounter };\r\n}\r\n\r\nexport function encounterStart(encounter: Encounter): PayloadAction<Encounter> {\r\n    return { type: EncounterAction.START, payload: encounter };\r\n}\r\n\r\nexport function encounterReset(): Action {\r\n    return { type: EncounterAction.RESET };\r\n}\r\n\r\nexport function encounterSelectChoice(choice: EncounterChoice): PayloadAction<EncounterChoice> {\r\n    return { type: EncounterAction.SELECT_CHOICE, payload: choice };\r\n}\r\n\r\nexport function setStageState(state: StageState): PayloadAction<StageState> {\r\n    return { type: EncounterAction.SET_STAGE_STATE, payload: state };\r\n}\r\n\r\nexport function encounterEnd(): Action {\r\n    return { type: EncounterAction.END };\r\n}\r\n\r\nexport function encounterRoll(\r\n    cost: number,\r\n    dieFaces = 20,\r\n    dieCount = 1\r\n): PayloadAction<EncounterRollDef> {\r\n    return { type: EncounterAction.ROLL, payload: { roll: roll(dieCount, dieFaces), cost } };\r\n}\r\n\r\nexport function encounterRollContinue(player: Player): PayloadAction<Player> {\r\n    return { type: EncounterAction.ROLL_CONTINUE, payload: player };\r\n}\r\n\r\nexport function encounterSetStage(stageId: string): PayloadAction<string> {\r\n    return { type: EncounterAction.SET_STAGE, payload: stageId };\r\n}\r\n","export enum Scene {\n    ENCOUNTER_SELECT = 'ENCOUNTER_SELECT',\n    ENCOUNTER = 'ENCOUNTER',\n    ENCOUNTER_END = 'ENCOUNTER_END',\n}\n","import { Scene } from '../../enums';\nimport { PayloadAction } from '../redux-utils';\n\nexport enum GameActions {\n    SET_SCENE = 'SET_SCENE',\n}\n\nexport function setScene(scene: Scene): PayloadAction<Scene> {\n    return { type: GameActions.SET_SCENE, payload: scene };\n}\n","export type Callback<T> = (t: T) => void;\n\nexport function noop(...args: any[]): void {\n    return;\n}\n","export function roll(dieCount: number, dieFaces: number): number {\n    let sum = 0;\n    for (let i = 0; i < dieCount; i++) {\n        sum += randomInt(1, dieFaces);\n    }\n    return sum;\n}\n\nexport function randomInt(min = 1, max = 6): number {\n    return min + Math.floor(Math.random() * (1 + max - min));\n}\n","import React, { ChangeEvent, Component, ReactElement } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { Callback, noop } from '../../../common/functions';\r\nimport { Encounter } from '../../../common/model/encounter/Encounter';\r\nimport { encounterStart } from '../../../common/redux/encounter/encounterActions';\r\nimport { Scene } from '../../enums';\r\nimport { setScene } from '../../redux/actions/game-actions';\r\nimport { State } from '../../redux/store';\r\nimport './EncounterSelection.scss';\r\n\r\nexport interface EncounterSelectionProps {\r\n    encounters: Encounter[];\r\n    onSelectEncounter: Callback<Encounter>;\r\n}\r\n\r\nexport interface EncounterSelectionState {\r\n    selectedEncounter: Encounter;\r\n}\r\n\r\nexport class EncounterSelectionComponent extends Component<\r\n    EncounterSelectionProps,\r\n    EncounterSelectionState\r\n> {\r\n    public static defaultProps: Partial<EncounterSelectionProps> = {\r\n        encounters: [],\r\n        onSelectEncounter: noop,\r\n    };\r\n\r\n    public constructor(props: EncounterSelectionProps) {\r\n        super(props);\r\n        this.state = { selectedEncounter: null };\r\n        this.onSelectChange = this.onSelectChange.bind(this);\r\n        this.onSelectEncounter = this.onSelectEncounter.bind(this);\r\n    }\r\n\r\n    public render(): ReactElement {\r\n        const { encounters } = this.props;\r\n        return (\r\n            <div className=\"EncounterSelection\">\r\n                <section>\r\n                    <ul className=\"encounter-stats-list\">\r\n                        <li>\r\n                            <span className=\"key\">Encounters Available: </span>\r\n                            <span className=\"value\">{encounters.length}</span>\r\n                        </li>\r\n                    </ul>\r\n                </section>\r\n                <hr />\r\n                <section className=\"encounter-selection-form\">\r\n                    <label htmlFor=\"encounter-select\">\r\n                        <span>Select Encounter: </span>\r\n                        <select\r\n                            id=\"encounter-select\"\r\n                            value={this.state.selectedEncounter?.id}\r\n                            onChange={this.onSelectChange}\r\n                        >\r\n                            <option value=\"\" />\r\n                            {encounters.map((encounter) => (\r\n                                <option key={encounter.id} value={encounter.id}>\r\n                                    {encounter.name}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </label>\r\n                    <button\r\n                        className=\"primary\"\r\n                        disabled={!this.state.selectedEncounter}\r\n                        onClick={this.onSelectEncounter}\r\n                    >\r\n                        Start Encounter\r\n                    </button>\r\n                </section>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private onSelectChange(e: ChangeEvent<HTMLSelectElement>): void {\r\n        const encounterId = e.currentTarget.value;\r\n        const encounter = this.props.encounters.find((e) => e.id === encounterId) ?? null;\r\n        this.setState({ selectedEncounter: encounter });\r\n    }\r\n\r\n    private onSelectEncounter(): void {\r\n        const { selectedEncounter } = this.state;\r\n        if (selectedEncounter) {\r\n            this.props.onSelectEncounter(selectedEncounter);\r\n        }\r\n    }\r\n}\r\n\r\nexport const EncounterSelection = connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(EncounterSelectionComponent as any);\r\n\r\nfunction mapStateToProps(state: State): Partial<EncounterSelectionProps> {\r\n    return {\r\n        encounters: Object.values(state.encounter.byId),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch): Partial<EncounterSelectionProps> {\r\n    return {\r\n        onSelectEncounter(encounter: Encounter): void {\r\n            dispatch(encounterStart(encounter));\r\n            dispatch(setScene(Scene.ENCOUNTER));\r\n        },\r\n    };\r\n}\r\n","import React, { ReactElement } from 'react';\r\n\r\nexport interface EncounterStageTextProps {\r\n    text: string[];\r\n}\r\n\r\nexport const EncounterStageText = ({ text }: EncounterStageTextProps): ReactElement => {\r\n    return (\r\n        <div className=\"EncounterStageText\">\r\n            {text.map((t) => (\r\n                <p>{t}</p>\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n","import { WithId, WithText } from './Encounter';\nimport { EncounterChoice } from './EncounterChoice';\n\nexport enum EncounterStageType {\n    CHOICE = 'CHOICE',\n}\n\nexport interface EncounterStageBase extends WithId, WithText {\n    type: EncounterStageType;\n}\n\nexport interface ChoicesStage extends EncounterStageBase {\n    type: EncounterStageType.CHOICE;\n    choices: EncounterChoice[];\n}\n\nexport type EncounterStage = ChoicesStage;\n\nexport function instanceOfChoicesStage(stage: EncounterStage): stage is ChoicesStage {\n    return stage.type === EncounterStageType.CHOICE;\n}\n","import { Encounter } from './Encounter';\nimport { EncounterChoice } from './EncounterChoice';\nimport { EncounterOutcome } from './EncounterOutcome';\nimport { EncounterStage } from './EncounterStage';\n\nexport enum StageState {\n    INIT = 'INIT',\n    PICKED = 'PICKED',\n}\n\nexport enum RollState {\n    INIT = 'INIT',\n    ROLLED = 'ROLLED',\n}\n\nexport enum RollOutcomeType {\n    CRITICAL_SUCCESS = 'Critical Success',\n    SUCCESS = 'Success',\n    FAILURE = 'Failure',\n    CRITICAL_FAILURE = 'Critical Failure',\n}\n\nexport interface ActiveEncounter {\n    encounter: Encounter;\n    stage: EncounterStage;\n    stageState: StageState;\n    choice?: EncounterChoice;\n    rolls?: number[];\n    rollState?: RollState;\n    rollOutcome?: EncounterOutcome;\n    rollOutcomeType?: RollOutcomeType;\n    rollTotal?: number;\n}\n","export enum Stat {\n    STR = 'strength',\n    DEX = 'dexterity',\n    CON = 'constitution',\n    WIS = 'wisdom',\n    INT = 'intelligence',\n    CHA = 'charisma',\n}\n\nexport interface PlayerStats {\n    maxWillpower: number;\n    willpower: number;\n    strength: number;\n    dexterity: number;\n    constitution: number;\n    wisdom: number;\n    intelligence: number;\n    charisma: number;\n}\n\nexport interface PlayerDescription {\n    name: string;\n}\n\nexport interface Player extends PlayerDescription, PlayerStats {}\n","import { Player, Stat } from '../../combat-sandbox-1/Player';\nimport { EncounterChoice } from '../model/encounter/EncounterChoice';\n\nconst statNames: Record<Stat, string> = {\n    [Stat.STR]: 'Strength',\n    [Stat.DEX]: 'Dexterity',\n    [Stat.CON]: 'Constitution',\n    [Stat.WIS]: 'Wisdom',\n    [Stat.INT]: 'Intelligence',\n    [Stat.CHA]: 'Charisma',\n};\nconst statAbbreviations: Record<Stat, string> = {\n    [Stat.STR]: 'STR',\n    [Stat.DEX]: 'DEX',\n    [Stat.CON]: 'CON',\n    [Stat.WIS]: 'WIS',\n    [Stat.INT]: 'INT',\n    [Stat.CHA]: 'CHA',\n};\n\nexport function getRequiredStats({ requirements }: EncounterChoice): Stat[] {\n    return Object.keys(requirements) as Stat[];\n}\n\nexport function checkChoiceRequirements(player: Player, choice: EncounterChoice): boolean {\n    if (!choice.requirements) return true;\n    const stats = getRequiredStats(choice);\n    return stats.every((stat) => player[stat] >= choice.requirements[stat]);\n}\n\nexport function getStatName(stat: Stat): string {\n    return statNames[stat];\n}\n\nexport function getStatAbbreviation(stat: Stat): string {\n    return statAbbreviations[stat];\n}\n","import classNames from 'classnames';\r\nimport React, { ReactElement, useCallback } from 'react';\r\nimport {\r\n    checkChoiceRequirements,\r\n    getRequiredStats,\r\n    getStatAbbreviation,\r\n} from '../../../../common/encounter/encounterUtils';\r\nimport { Callback, noop } from '../../../../common/functions';\r\nimport { EncounterChoice } from '../../../../common/model/encounter/EncounterChoice';\r\nimport { Player } from '../../../Player';\r\n\r\nexport interface ChoiceItemProps<C extends EncounterChoice> {\r\n    player: Player;\r\n    choice: C;\r\n    onSelect: Callback<C>;\r\n    fixed?: boolean;\r\n}\r\n\r\nexport const ChoiceItem = (props: ChoiceItemProps<EncounterChoice>): ReactElement => {\r\n    const { player, choice, fixed } = props;\r\n    let { onSelect } = props;\r\n    const disabled = !checkChoiceRequirements(player, choice);\r\n    if (disabled || typeof onSelect !== 'function') {\r\n        onSelect = noop;\r\n    }\r\n\r\n    const onClick = useCallback(() => onSelect(choice), [choice, onSelect]);\r\n    let requirementsText = '';\r\n    if (choice.requirements) {\r\n        const stats = getRequiredStats(choice);\r\n        if (stats.length) {\r\n            requirementsText = stats\r\n                .map((stat) => `${choice.requirements[stat]} ${getStatAbbreviation(stat)}`)\r\n                .join(', ');\r\n            requirementsText = `[${requirementsText}]`;\r\n        }\r\n    }\r\n    return (\r\n        <li\r\n            className={classNames([\r\n                'ChoiceItem',\r\n                'EndEncounterChoiceItem',\r\n                {\r\n                    fixed: !!fixed,\r\n                    disabled,\r\n                },\r\n            ])}\r\n            onClick={onClick}\r\n        >\r\n            <span className=\"requirements\">{requirementsText} </span>\r\n            <span>{choice.description}</span>\r\n        </li>\r\n    );\r\n};\r\n","import React, { ReactElement } from 'react';\r\nimport { Callback } from '../../../../common/functions';\r\nimport { EncounterChoice } from '../../../../common/model/encounter/EncounterChoice';\r\nimport { Player } from '../../../Player';\r\nimport { ChoiceItem } from './ChoiceItem';\r\nimport './ChoiceItemList.scss';\r\n\r\nexport interface ChoiceItemListProps {\r\n    player: Player;\r\n    choices: EncounterChoice[];\r\n    onSelect?: Callback<EncounterChoice>;\r\n    fixed?: boolean;\r\n}\r\n\r\nexport const ChoiceItemList = ({\r\n    player,\r\n    choices,\r\n    onSelect,\r\n    fixed,\r\n}: ChoiceItemListProps): ReactElement => (\r\n    <ul className=\"ChoiceItemList\">\r\n        {choices.map((choice) => (\r\n            <ChoiceItem player={player} choice={choice} onSelect={onSelect} fixed={fixed} />\r\n        ))}\r\n    </ul>\r\n);\r\n","import { Stat } from '../../../combat-sandbox-1/Player';\nimport { WithText } from './Encounter';\nimport { EncounterOutcome } from './EncounterOutcome';\n\nexport enum ChoiceType {\n    END_ENCOUNTER = 'END_ENCOUNTER',\n    ROLL = 'ROLL',\n}\n\nexport type ChoiceRequirements = Partial<Record<Stat, number>>;\n\nexport interface EncounterChoiceBase {\n    type: ChoiceType;\n    description: string;\n    requirements?: ChoiceRequirements;\n}\n\nexport interface EndEncounterChoice extends EncounterChoiceBase, WithText {\n    type: ChoiceType.END_ENCOUNTER;\n    continueText: string;\n}\n\nexport interface RollChoice extends EncounterChoiceBase {\n    type: ChoiceType.ROLL;\n    dc: number;\n    outcomes: {\n        criticalSuccess?: EncounterOutcome;\n        success: EncounterOutcome;\n        failure: EncounterOutcome;\n        criticalFailure?: EncounterOutcome;\n    };\n}\n\nexport type EncounterChoice = EndEncounterChoice | RollChoice;\n\nexport function instanceOfEndEncounterChoice(\n    choice: EncounterChoice\n): choice is EndEncounterChoice {\n    return choice.type === ChoiceType.END_ENCOUNTER;\n}\n\nexport function instanceofRollChoice(choice: EncounterChoice): choice is RollChoice {\n    return choice.type === ChoiceType.ROLL;\n}\n","import React, { ReactElement } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { ActiveEncounter } from '../../../../common/model/encounter/ActiveEncounter';\r\nimport { EndEncounterChoice } from '../../../../common/model/encounter/EncounterChoice';\r\nimport { ChoicesStage } from '../../../../common/model/encounter/EncounterStage';\r\nimport { encounterEnd } from '../../../../common/redux/encounter/encounterActions';\r\nimport { Scene } from '../../../enums';\r\nimport { Player } from '../../../Player';\r\nimport { setScene } from '../../../redux/actions/game-actions';\r\nimport { State } from '../../../redux/store';\r\nimport { ChoiceItemList } from '../ChoiceItemList/ChoiceItemList';\r\n\r\nexport interface EndEncounterChoiceViewWrapperProps {\r\n    stage: ChoicesStage;\r\n    choice: EndEncounterChoice;\r\n}\r\n\r\nexport interface EndEncounterChoiceViewProps extends EndEncounterChoiceViewWrapperProps {\r\n    player: Player;\r\n    activeEncounter: ActiveEncounter;\r\n    onContinue: () => void;\r\n}\r\n\r\nconst render = ({ player, choice, onContinue }: EndEncounterChoiceViewProps): ReactElement => (\r\n    <div className=\"EndEncounterChoiceView\">\r\n        <ChoiceItemList player={player} choices={[choice]} fixed />\r\n        {choice.text.map((t) => (\r\n            <p>{t}</p>\r\n        ))}\r\n        <button className=\"primary\" onClick={onContinue}>\r\n            {choice.continueText}\r\n        </button>\r\n    </div>\r\n);\r\n\r\nfunction mapStateToProps(\r\n    state: State,\r\n    ownProps: EndEncounterChoiceViewWrapperProps\r\n): Partial<EndEncounterChoiceViewProps> {\r\n    return {\r\n        ...ownProps,\r\n        player: state.player,\r\n        activeEncounter: state.encounter.active,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch): Partial<EndEncounterChoiceViewProps> {\r\n    return {\r\n        onContinue(): void {\r\n            dispatch(encounterEnd());\r\n            dispatch(setScene(Scene.ENCOUNTER_END));\r\n        },\r\n    };\r\n}\r\n\r\nexport const EndEncounterChoiceView = connect(mapStateToProps, mapDispatchToProps)(render);\r\n","import { WithText } from './Encounter';\r\n\r\nexport enum OutcomeType {\r\n    NEXT_STAGE = 'NEXT_STAGE',\r\n    END_ENCOUNTER = 'END_ENCOUNTER',\r\n}\r\n\r\nexport interface EncounterOutcomeBase extends WithText {\r\n    type: OutcomeType;\r\n    continueText: string;\r\n}\r\n\r\nexport interface NextStageOutcome extends EncounterOutcomeBase {\r\n    type: OutcomeType.NEXT_STAGE;\r\n    nextStageId: string;\r\n}\r\n\r\nexport interface EndEncounterOutcome extends EncounterOutcomeBase {\r\n    type: OutcomeType.END_ENCOUNTER;\r\n}\r\n\r\nexport type EncounterOutcome = NextStageOutcome | EndEncounterOutcome;\r\n\r\nexport function instanceOfNextStageOutcome(outcome: EncounterOutcome): outcome is NextStageOutcome {\r\n    return outcome.type === OutcomeType.NEXT_STAGE;\r\n}\r\n\r\nexport function instanceOfEndEncounterOutcome(\r\n    outcome: EncounterOutcome\r\n): outcome is EndEncounterOutcome {\r\n    return outcome.type === OutcomeType.END_ENCOUNTER;\r\n}\r\n","import classNames from 'classnames';\r\nimport React, { ReactElement, useCallback } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { getRequiredStats, getStatName } from '../../../../common/encounter/encounterUtils';\r\nimport { Callback } from '../../../../common/functions';\r\nimport { ActiveEncounter, RollState } from '../../../../common/model/encounter/ActiveEncounter';\r\nimport { RollChoice } from '../../../../common/model/encounter/EncounterChoice';\r\nimport {\r\n    instanceOfEndEncounterOutcome,\r\n    instanceOfNextStageOutcome,\r\n} from '../../../../common/model/encounter/EncounterOutcome';\r\nimport { ChoicesStage } from '../../../../common/model/encounter/EncounterStage';\r\nimport {\r\n    encounterEnd,\r\n    encounterRoll,\r\n    encounterRollContinue,\r\n    encounterSetStage,\r\n} from '../../../../common/redux/encounter/encounterActions';\r\nimport { Scene } from '../../../enums';\r\nimport { Player } from '../../../Player';\r\nimport { setScene } from '../../../redux/actions/game-actions';\r\nimport { State } from '../../../redux/store';\r\nimport { ChoiceItemList } from '../ChoiceItemList/ChoiceItemList';\r\nimport './RollChoiceView.scss';\r\n\r\nexport interface RollChoiceViewWrapperProps {\r\n    stage: ChoicesStage;\r\n    choice: RollChoice;\r\n}\r\n\r\nexport interface RollChoiceViewProps extends RollChoiceViewWrapperProps {\r\n    player: Player;\r\n    activeEncounter: ActiveEncounter;\r\n    onRoll: Callback<number>;\r\n    onContinue: Callback<Player>;\r\n    onRolledContinue: Callback<ActiveEncounter>;\r\n}\r\n\r\nconst RollChoiceInitView = ({\r\n    player,\r\n    activeEncounter,\r\n    choice,\r\n    onRoll,\r\n    onContinue,\r\n}: RollChoiceViewProps): ReactElement => {\r\n    const rolls = activeEncounter.rolls ?? [];\r\n    const canContinue = !!rolls.length;\r\n    const rollCost = rolls.length ? 1 : 0;\r\n    const canRoll = !rolls.length || player.willpower > 0;\r\n    const rollCallback = useCallback(() => onRoll(rollCost), [rollCost]);\r\n    const stats = getRequiredStats(choice);\r\n    const statSum = stats.reduce((s, stat) => s + choice.requirements[stat], 0);\r\n    const rollSum = rolls.reduce((s, roll) => s + roll, 0);\r\n    const continueCallback = useCallback(() => onContinue(player), [player]);\r\n    return (\r\n        <div className=\"RollChoiceView\">\r\n            <ChoiceItemList player={player} choices={[choice]} fixed />\r\n            <div className=\"buttons\">\r\n                {canContinue && (\r\n                    <button className=\"primary\" onClick={continueCallback}>\r\n                        Continue\r\n                    </button>\r\n                )}\r\n                <button\r\n                    className={classNames({ primary: !rollCost })}\r\n                    disabled={!canRoll}\r\n                    onClick={rollCallback}\r\n                >\r\n                    {`Roll${rollCost ? ' [1 WIL]' : ''}`}\r\n                </button>\r\n            </div>\r\n            <table className=\"roll-table\">\r\n                <tbody>\r\n                    {stats.map((stat) => (\r\n                        <tr>\r\n                            <th>{getStatName(stat)}</th>\r\n                            <td>{choice.requirements[stat]}</td>\r\n                        </tr>\r\n                    ))}\r\n                    {rolls.map((roll, i) => (\r\n                        <tr>\r\n                            <th>Roll {i + 1}</th>\r\n                            <td>{roll}</td>\r\n                        </tr>\r\n                    ))}\r\n                    <tr className=\"sum-row\">\r\n                        <th>Total</th>\r\n                        <td>{statSum + rollSum}</td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst RollChoiceRolledView = ({\r\n    player,\r\n    activeEncounter,\r\n    choice,\r\n    onRolledContinue,\r\n}: RollChoiceViewProps): ReactElement => {\r\n    const onContinueClick = useCallback(() => onRolledContinue(activeEncounter), [activeEncounter]);\r\n    return (\r\n        <div className=\"RollChoiceView\">\r\n            <ChoiceItemList player={player} choices={[choice]} fixed />\r\n            <table className=\"roll-table\">\r\n                <tbody>\r\n                    <tr>\r\n                        <th>Your Roll:</th>\r\n                        <td>{activeEncounter.rollTotal}</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <th>Outcome:</th>\r\n                        <td>{activeEncounter.rollOutcomeType}</td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n            {activeEncounter.rollOutcome.text.map((t) => (\r\n                <p>{t}</p>\r\n            ))}\r\n            <button className=\"primary\" onClick={onContinueClick}>\r\n                {activeEncounter.rollOutcome.continueText}\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst render = (props: RollChoiceViewProps): ReactElement => {\r\n    switch (props.activeEncounter.rollState) {\r\n        case RollState.INIT:\r\n            return <RollChoiceInitView {...props} />;\r\n        case RollState.ROLLED:\r\n            return <RollChoiceRolledView {...props} />;\r\n        default:\r\n            return null;\r\n    }\r\n};\r\n\r\nfunction mapStateToProps(\r\n    state: State,\r\n    ownProps: RollChoiceViewWrapperProps\r\n): Partial<RollChoiceViewProps> {\r\n    return {\r\n        ...ownProps,\r\n        player: state.player,\r\n        activeEncounter: state.encounter.active,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch): Partial<RollChoiceViewProps> {\r\n    return {\r\n        onRoll(cost): void {\r\n            dispatch(encounterRoll(cost));\r\n        },\r\n        onContinue(player: Player): void {\r\n            dispatch(encounterRollContinue(player));\r\n        },\r\n        onRolledContinue({ rollOutcome }: ActiveEncounter): void {\r\n            if (instanceOfEndEncounterOutcome(rollOutcome)) {\r\n                dispatch(encounterEnd());\r\n                dispatch(setScene(Scene.ENCOUNTER_END));\r\n            } else if (instanceOfNextStageOutcome(rollOutcome)) {\r\n                dispatch(encounterSetStage(rollOutcome.nextStageId));\r\n            }\r\n        },\r\n    };\r\n}\r\n\r\nexport const RollChoiceView = connect(mapStateToProps, mapDispatchToProps)(render);\r\n","import React, { ReactElement } from 'react';\r\nimport { ActiveEncounter } from '../../../../common/model/encounter/ActiveEncounter';\r\nimport {\r\n    instanceOfEndEncounterChoice,\r\n    instanceofRollChoice,\r\n} from '../../../../common/model/encounter/EncounterChoice';\r\nimport { ChoicesStage } from '../../../../common/model/encounter/EncounterStage';\r\nimport { EndEncounterChoiceView } from '../choiceTypes/EndEncounterChoiceView';\r\nimport { RollChoiceView } from '../choiceTypes/RollChoiceView';\r\n\r\nexport interface PickedStateViewProps {\r\n    activeEncounter: ActiveEncounter;\r\n    stage: ChoicesStage;\r\n}\r\n\r\nexport const PickedStateView = function PickedStateView({\r\n    activeEncounter,\r\n    stage,\r\n}: PickedStateViewProps): ReactElement {\r\n    const { choice } = activeEncounter;\r\n    if (instanceOfEndEncounterChoice(choice)) {\r\n        return <EndEncounterChoiceView stage={stage} choice={choice} />;\r\n    } else if (instanceofRollChoice(choice)) {\r\n        return <RollChoiceView stage={stage} choice={choice} />;\r\n    }\r\n    return <div>PickedStateView</div>;\r\n};\r\n","import React, { ComponentType, ReactElement } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { Callback } from '../../../../common/functions';\r\nimport { ActiveEncounter, StageState } from '../../../../common/model/encounter/ActiveEncounter';\r\nimport { EncounterChoice } from '../../../../common/model/encounter/EncounterChoice';\r\nimport { ChoicesStage } from '../../../../common/model/encounter/EncounterStage';\r\nimport { encounterSelectChoice } from '../../../../common/redux/encounter/encounterActions';\r\nimport { Player } from '../../../Player';\r\nimport { State } from '../../../redux/store';\r\nimport { ChoiceItemList } from '../ChoiceItemList/ChoiceItemList';\r\nimport { PickedStateView } from './PickedStateView';\r\n\r\nexport interface ChoicesStageViewProps {\r\n    player: Player;\r\n    activeEncounter: ActiveEncounter;\r\n    stage: ChoicesStage;\r\n    onChoiceSelect?: Callback<EncounterChoice>;\r\n}\r\n\r\nconst InitStateView = ({ player, stage, onChoiceSelect }: ChoicesStageViewProps): ReactElement => (\r\n    <ChoiceItemList player={player} choices={stage.choices} onSelect={onChoiceSelect} />\r\n);\r\n\r\nfunction getStateView(state: StageState): ComponentType<ChoicesStageViewProps> {\r\n    switch (state) {\r\n        case StageState.INIT:\r\n            return InitStateView;\r\n        case StageState.PICKED:\r\n            return PickedStateView;\r\n        default:\r\n            return null;\r\n    }\r\n}\r\n\r\nconst render = (props: ChoicesStageViewProps) => {\r\n    const { activeEncounter } = props;\r\n    const StateView = getStateView(activeEncounter.stageState);\r\n    return (\r\n        <div className=\"ChoicesStageView\">\r\n            <StateView {...props} />\r\n        </div>\r\n    );\r\n};\r\n\r\nfunction mapStateToProps(state: State): Partial<ChoicesStageViewProps> {\r\n    return {\r\n        player: state.player,\r\n        activeEncounter: state.encounter.active,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch): Partial<ChoicesStageViewProps> {\r\n    return {\r\n        onChoiceSelect(choice: EncounterChoice): void {\r\n            dispatch(encounterSelectChoice(choice));\r\n        },\r\n    };\r\n}\r\n\r\nexport const ChoicesStageView = connect(mapStateToProps, mapDispatchToProps)(render);\r\n","import React, { ComponentType, ReactElement } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { ActiveEncounter } from '../../../common/model/encounter/ActiveEncounter';\r\nimport {\r\n    EncounterStage,\r\n    instanceOfChoicesStage,\r\n} from '../../../common/model/encounter/EncounterStage';\r\nimport { State } from '../../redux/store';\r\nimport { ChoicesStageView } from './stageTypes/ChoicesStageView';\r\n\r\nexport interface StageTypeViewProps {\r\n    activeEncounter: ActiveEncounter;\r\n}\r\n\r\nexport interface StageViewProps<S extends EncounterStage> {\r\n    stage: S;\r\n}\r\n\r\nfunction getStageView<S extends EncounterStage>(\r\n    stage: EncounterStage\r\n): ComponentType<StageViewProps<S>> {\r\n    if (instanceOfChoicesStage(stage)) return ChoicesStageView;\r\n    return null;\r\n}\r\n\r\nconst render = ({ activeEncounter }: StageTypeViewProps): ReactElement => {\r\n    const StageView = getStageView(activeEncounter.stage);\r\n    return StageView ? <StageView stage={activeEncounter.stage} /> : null;\r\n};\r\n\r\nfunction mapStateToProps(state: State): Partial<StageTypeViewProps> {\r\n    return { activeEncounter: state.encounter.active };\r\n}\r\n\r\nexport const StageTypeView = connect(mapStateToProps)(render);\r\n","import React, { ReactElement } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { ActiveEncounter } from '../../../common/model/encounter/ActiveEncounter';\r\nimport { State } from '../../redux/store';\r\nimport { EncounterStageText } from './EncounterStageText';\r\nimport { StageTypeView } from './StageTypeView';\r\n\r\nexport interface EncounterStageViewProps {\r\n    activeEncounter: ActiveEncounter;\r\n}\r\n\r\nconst render = ({ activeEncounter }: EncounterStageViewProps): ReactElement => (\r\n    <div className=\"EncounterStageView\">\r\n        <EncounterStageText text={activeEncounter.stage.text} />\r\n        <hr />\r\n        <StageTypeView />\r\n    </div>\r\n);\r\n\r\nfunction mapStateToProps(state: State): Partial<EncounterStageViewProps> {\r\n    return { activeEncounter: state.encounter.active };\r\n}\r\n\r\nexport const EncounterStageView = connect(mapStateToProps)(render);\r\n","import React, { ReactElement } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { State } from '../../redux/store';\r\nimport { EncounterStageView } from './EncounterStageView';\r\nimport './EncounterView.scss';\r\n\r\nconst mimic = require('../../assets/mimic.jpg');\r\n\r\nexport interface EncounterViewProps {}\r\n\r\nconst render = (props: EncounterViewProps): ReactElement => (\r\n    <div className=\"EncounterView\">\r\n        <EncounterStageView />\r\n        <img src={mimic} alt=\"A mimic\" />\r\n    </div>\r\n);\r\n\r\nfunction mapStateToProps(state: State): Partial<EncounterViewProps> {\r\n    return {};\r\n}\r\n\r\nexport const EncounterView = connect(mapStateToProps)(render);\r\n","import React, { ReactElement } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { encounterReset } from '../../../common/redux/encounter/encounterActions';\r\nimport { Scene } from '../../enums';\r\nimport { setScene } from '../../redux/actions/game-actions';\r\nimport { State } from '../../redux/store';\r\nimport { EncounterSelection } from '../encounter/EncounterSelection';\r\nimport { EncounterView } from '../encounter/EncounterView';\r\nimport './EncounterPanel.scss';\r\n\r\nconst sceneTitles: Record<Scene, string> = {\r\n    [Scene.ENCOUNTER_SELECT]: 'Encounter Selection',\r\n    [Scene.ENCOUNTER]: 'Encounter Preview',\r\n    [Scene.ENCOUNTER_END]: 'Encounter Complete',\r\n};\r\n\r\nexport interface EncounterPanelProps {\r\n    currentScene: Scene;\r\n    onReset(): void;\r\n}\r\n\r\nconst renderView = (currentScene: Scene, onReset: () => void): ReactElement => {\r\n    switch (currentScene) {\r\n        case Scene.ENCOUNTER_SELECT:\r\n            return <EncounterSelection />;\r\n        case Scene.ENCOUNTER:\r\n            return <EncounterView />;\r\n        case Scene.ENCOUNTER_END:\r\n            return (\r\n                <div>\r\n                    <p>Congratulations! You finished the encounter!</p>\r\n                    <button className=\"primary\" onClick={onReset}>\r\n                        Start again?\r\n                    </button>\r\n                </div>\r\n            );\r\n        default:\r\n            return null;\r\n    }\r\n};\r\n\r\nexport const EncounterPanel = connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(\r\n    ({ currentScene, onReset }: EncounterPanelProps): ReactElement => {\r\n        return (\r\n            <div className=\"EncounterPanel\">\r\n                <h3 className=\"header-with-buttons\">\r\n                    <span>{sceneTitles[currentScene]}</span>\r\n                    <button onClick={onReset} disabled={currentScene === Scene.ENCOUNTER_SELECT}>\r\n                        Reset\r\n                    </button>\r\n                </h3>\r\n                {renderView(currentScene, onReset)}\r\n            </div>\r\n        );\r\n    }\r\n);\r\n\r\nfunction mapStateToProps({ currentScene }: State): Partial<EncounterPanelProps> {\r\n    return { currentScene };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch): Partial<EncounterPanelProps> {\r\n    return {\r\n        onReset() {\r\n            dispatch(encounterReset());\r\n            dispatch(setScene(Scene.ENCOUNTER_SELECT));\r\n        },\r\n    };\r\n}\r\n","import { Player, PlayerDescription, PlayerStats } from '../../Player';\nimport { PayloadAction } from '../redux-utils';\n\nexport enum PlayerActions {\n    SET_PLAYER = 'SET_PLAYER',\n    SET_PLAYER_DESCRIPTION = 'SET_PLAYER_DESCRIPTION',\n    SET_PLAYER_STAT = 'SET_PLAYER_STAT',\n}\n\nexport interface PlayerStatUpdate {\n    statName: keyof PlayerStats;\n    value: number;\n}\n\nexport interface PlayerDescriptionUpdate {\n    key: keyof PlayerDescription;\n    value: string;\n}\n\nexport function setPlayer(player: Player): PayloadAction<Player> {\n    return { type: PlayerActions.SET_PLAYER, payload: player };\n}\n\nexport function setDescription(\n    key: keyof PlayerDescription,\n    value: string\n): PayloadAction<PlayerDescriptionUpdate> {\n    return {\n        type: PlayerActions.SET_PLAYER_DESCRIPTION,\n        payload: { key, value },\n    };\n}\n\nexport function setStat(\n    statName: keyof PlayerStats,\n    value: number\n): PayloadAction<PlayerStatUpdate> {\n    return {\n        type: PlayerActions.SET_PLAYER_STAT,\n        payload: { statName, value },\n    };\n}\n","import { Action, Reducer } from 'redux';\nimport {\n    EncounterAction,\n    EncounterRollDef,\n} from '../../../common/redux/encounter/encounterActions';\nimport { Player } from '../../Player';\nimport {\n    PlayerActions,\n    PlayerDescriptionUpdate,\n    PlayerStatUpdate,\n} from '../actions/player-actions';\nimport { PayloadAction } from '../redux-utils';\n\nconst reducerMap: Record<string, Reducer<Player>> = {\n    [PlayerActions.SET_PLAYER]: setPlayerReducer,\n    [PlayerActions.SET_PLAYER_DESCRIPTION]: setPlayerDescriptionReducer,\n    [PlayerActions.SET_PLAYER_STAT]: setPlayerStatReducer,\n    [EncounterAction.ROLL]: encounterRollReducer,\n};\n\nexport function playerReducer(player = defaultPlayer(), action: Action): Player {\n    const reducer = reducerMap[action.type];\n    return reducer ? reducer(player, action) : player;\n}\n\nexport function defaultPlayer(): Player {\n    return {\n        name: 'Firecrotch',\n        maxWillpower: 10,\n        willpower: 10,\n        strength: 2,\n        dexterity: 2,\n        constitution: 2,\n        wisdom: 2,\n        intelligence: 2,\n        charisma: 2,\n    };\n}\n\nfunction setPlayerReducer(player: Player, { payload }: PayloadAction<Player>): Player {\n    if (payload === player) {\n        return player;\n    }\n    return { ...payload };\n}\n\nfunction setPlayerDescriptionReducer(\n    player: Player,\n    { payload: { key, value } }: PayloadAction<PlayerDescriptionUpdate>\n): Player {\n    if (player[key] === value) {\n        return player;\n    }\n    return { ...player, [key]: value };\n}\n\nfunction setPlayerStatReducer(\n    player: Player,\n    { payload: { statName, value } }: PayloadAction<PlayerStatUpdate>\n): Player {\n    if (player[statName] === value) {\n        return player;\n    }\n    return { ...player, [statName]: value };\n}\n\nfunction encounterRollReducer(\n    player: Player,\n    { payload }: PayloadAction<EncounterRollDef>\n): Player {\n    if (!payload || !payload.cost) {\n        return player;\n    }\n    return {\n        ...player,\n        willpower: player.willpower - payload.cost,\n    };\n}\n","import React, { HTMLProps, ReactElement } from 'react';\r\n\r\nexport interface PlayerConfigPanelInputProps<T> extends HTMLProps<HTMLInputElement> {\r\n    id: string;\r\n    label: string;\r\n}\r\n\r\nexport const PlayerConfigPanelInput = <T extends unknown>(\r\n    props: PlayerConfigPanelInputProps<T>\r\n): ReactElement => (\r\n    <label htmlFor={props.id}>\r\n        <span>{props.label}:</span>\r\n        <input {...props} />\r\n    </label>\r\n);\r\n","import React, { ChangeEvent, ReactElement } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { Callback } from '../../../common/functions';\r\nimport { Player } from '../../Player';\r\nimport { setDescription, setPlayer, setStat } from '../../redux/actions/player-actions';\r\nimport { defaultPlayer } from '../../redux/reducers/player-reducer';\r\nimport { State } from '../../redux/store';\r\nimport './PlayerConfigPanel.scss';\r\nimport { PlayerConfigPanelInput } from './PlayerConfigPanelInput';\r\n\r\nexport interface PlayerConfigPanelProps {\r\n    player: Player;\r\n    onPlayerReset: () => void;\r\n    onNameChange: Callback<ChangeEvent<HTMLInputElement>>;\r\n    onStrengthChange: Callback<ChangeEvent<HTMLInputElement>>;\r\n    onDexterityChange: Callback<ChangeEvent<HTMLInputElement>>;\r\n    onConstitutionChange: Callback<ChangeEvent<HTMLInputElement>>;\r\n    onWisdomChange: Callback<ChangeEvent<HTMLInputElement>>;\r\n    onIntelligenceChange: Callback<ChangeEvent<HTMLInputElement>>;\r\n    onCharismaChange: Callback<ChangeEvent<HTMLInputElement>>;\r\n    onMaxWillpowerChange: Callback<ChangeEvent<HTMLInputElement>>;\r\n    onWillpowerChange: Callback<ChangeEvent<HTMLInputElement>>;\r\n}\r\n\r\nconst render = ({\r\n    player,\r\n    onPlayerReset,\r\n    onNameChange,\r\n    onStrengthChange,\r\n    onDexterityChange,\r\n    onConstitutionChange,\r\n    onWisdomChange,\r\n    onIntelligenceChange,\r\n    onCharismaChange,\r\n    onMaxWillpowerChange,\r\n    onWillpowerChange,\r\n}: PlayerConfigPanelProps): ReactElement => (\r\n    <div className=\"PlayerConfigPanel\">\r\n        <h3 className=\"header-with-buttons\">\r\n            <span>Player</span>\r\n            <button onClick={onPlayerReset}>Reset</button>\r\n        </h3>\r\n        <PlayerConfigPanelInput\r\n            id=\"name-input\"\r\n            label=\"Name\"\r\n            type=\"text\"\r\n            value={player.name}\r\n            onChange={onNameChange}\r\n        />\r\n        <h4>Attributes</h4>\r\n        <div className=\"attribute-config\">\r\n            <PlayerConfigPanelInput\r\n                id=\"strength-input\"\r\n                label=\"Strength\"\r\n                type=\"number\"\r\n                value={player.strength}\r\n                min={1}\r\n                onChange={onStrengthChange}\r\n            />\r\n            <PlayerConfigPanelInput\r\n                id=\"dexterity-input\"\r\n                label=\"Dexterity\"\r\n                type=\"number\"\r\n                value={player.dexterity}\r\n                min={1}\r\n                onChange={onDexterityChange}\r\n            />\r\n            <PlayerConfigPanelInput\r\n                id=\"constitution-input\"\r\n                label=\"Constitution\"\r\n                type=\"number\"\r\n                value={player.constitution}\r\n                min={1}\r\n                onChange={onConstitutionChange}\r\n            />\r\n            <PlayerConfigPanelInput\r\n                id=\"wisdom-input\"\r\n                label=\"Wisdom\"\r\n                type=\"number\"\r\n                value={player.wisdom}\r\n                min={1}\r\n                onChange={onWisdomChange}\r\n            />\r\n            <PlayerConfigPanelInput\r\n                id=\"intelligence-input\"\r\n                label=\"Intelligence\"\r\n                type=\"number\"\r\n                value={player.intelligence}\r\n                min={1}\r\n                onChange={onIntelligenceChange}\r\n            />\r\n            <PlayerConfigPanelInput\r\n                id=\"charisma-input\"\r\n                label=\"Charisma\"\r\n                type=\"number\"\r\n                value={player.charisma}\r\n                min={1}\r\n                onChange={onCharismaChange}\r\n            />\r\n        </div>\r\n        <hr />\r\n        <h4>Resources</h4>\r\n        <PlayerConfigPanelInput\r\n            id=\"max-willpower-input\"\r\n            label=\"Max Willpower\"\r\n            type=\"number\"\r\n            value={player.maxWillpower}\r\n            min={1}\r\n            onChange={onMaxWillpowerChange}\r\n        />\r\n        <PlayerConfigPanelInput\r\n            id=\"willpower-input\"\r\n            label=\"Willpower\"\r\n            type=\"number\"\r\n            value={player.willpower}\r\n            min={0}\r\n            max={player.maxWillpower}\r\n            onChange={onWillpowerChange}\r\n        />\r\n    </div>\r\n);\r\n\r\nfunction mapStateToProps(state: State): Partial<PlayerConfigPanelProps> {\r\n    return {\r\n        player: state.player,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch): Partial<PlayerConfigPanelProps> {\r\n    return {\r\n        onPlayerReset(): void {\r\n            dispatch(setPlayer(defaultPlayer()));\r\n        },\r\n        onNameChange(e: ChangeEvent<HTMLInputElement>): void {\r\n            const value = e.currentTarget.value;\r\n            dispatch(setDescription('name', value));\r\n        },\r\n        onStrengthChange(e: ChangeEvent<HTMLInputElement>): void {\r\n            const value = Number(e.currentTarget.value);\r\n            dispatch(setStat('strength', value));\r\n        },\r\n        onDexterityChange(e: ChangeEvent<HTMLInputElement>): void {\r\n            const value = Number(e.currentTarget.value);\r\n            dispatch(setStat('dexterity', value));\r\n        },\r\n        onConstitutionChange(e: ChangeEvent<HTMLInputElement>): void {\r\n            const value = Number(e.currentTarget.value);\r\n            dispatch(setStat('constitution', value));\r\n        },\r\n        onWisdomChange(e: ChangeEvent<HTMLInputElement>): void {\r\n            const value = Number(e.currentTarget.value);\r\n            dispatch(setStat('wisdom', value));\r\n        },\r\n        onIntelligenceChange(e: ChangeEvent<HTMLInputElement>): void {\r\n            const value = Number(e.currentTarget.value);\r\n            dispatch(setStat('intelligence', value));\r\n        },\r\n        onCharismaChange(e: ChangeEvent<HTMLInputElement>): void {\r\n            const value = Number(e.currentTarget.value);\r\n            dispatch(setStat('charisma', value));\r\n        },\r\n        onMaxWillpowerChange(e: ChangeEvent<HTMLInputElement>): void {\r\n            const value = Number(e.currentTarget.value);\r\n            dispatch(setStat('maxWillpower', value));\r\n        },\r\n        onWillpowerChange(e: ChangeEvent<HTMLInputElement>): void {\r\n            const value = Number(e.currentTarget.value);\r\n            dispatch(setStat('willpower', value));\r\n        },\r\n    };\r\n}\r\n\r\nexport const PlayerConfigPanel = connect(mapStateToProps, mapDispatchToProps)(render);\r\n","import { Encounter } from '../common/model/encounter/Encounter';\r\nimport { ChoiceType } from '../common/model/encounter/EncounterChoice';\r\nimport { OutcomeType } from '../common/model/encounter/EncounterOutcome';\r\nimport { EncounterStageType } from '../common/model/encounter/EncounterStage';\r\nimport { Stat } from './Player';\r\n\r\nexport const encounter1: Encounter = {\r\n    id: '0d895b71-0029-4e82-9a20-ce883e891660',\r\n    name: 'An Old Chest',\r\n    entryStage: 'c0704d17-9746-489b-a3eb-a8cfc5b4bc76',\r\n    stages: [\r\n        {\r\n            id: 'c0704d17-9746-489b-a3eb-a8cfc5b4bc76',\r\n            type: EncounterStageType.CHOICE,\r\n            text: ['You see an old chest. It appears to be locked.', 'What do you do?'],\r\n            choices: [\r\n                {\r\n                    type: ChoiceType.ROLL,\r\n                    description: 'Break the chest open',\r\n                    requirements: { [Stat.STR]: 2 },\r\n                    dc: 10,\r\n                    outcomes: {\r\n                        criticalSuccess: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'You smash the chest so hard that it is reduced to splinters. Inside is the ruined body of a mimic as well as some gear left from a previous - less fortunate - adventurer',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                        success: {\r\n                            type: OutcomeType.NEXT_STAGE,\r\n                            text: [\r\n                                'You strike the chest hard, breaking open the wooden frame. Blood and flailing tendrils spring forth immediately. The chest was a mimic! Fortunately you have managed to wound it without placing yourself in danger.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                            nextStageId: '622df858-e07b-4b26-8237-6d755ffb368c',\r\n                        },\r\n                        failure: {\r\n                            type: OutcomeType.NEXT_STAGE,\r\n                            text: [\r\n                                'You strike the chest but your blow ricochets off leaving only superficial damage. To your surprise the chest opens in response and strong tendrils spring forth, entangling your limbs.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                            nextStageId: '622df858-e07b-4b26-8237-6d755ffb368c',\r\n                        },\r\n                        criticalFailure: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'Holding your weapon shakily you do your best to open the chest with force. Your strike throws you off balance and your blow barely glaces off the chest while you fall flat on the floor.',\r\n                                'While you scramble to regain your dignity the chest, surprisingly, opens. Before you can even regain your footing strong tendrils have launched from the chest and ensnared you thoroughly. You are slowly dragged towards the mimic.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                    },\r\n                },\r\n                {\r\n                    type: ChoiceType.ROLL,\r\n                    description: 'Pick the lock',\r\n                    requirements: { [Stat.DEX]: 3 },\r\n                    dc: 16,\r\n                    outcomes: {\r\n                        criticalSuccess: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'With well honed skill you deftly tease the lock open. In one smooth motion you remove the padlock and open the chest - all without making a sound.',\r\n                                'Inside you find a heaped mass of tentacles. A dormant mimic! You were lucky not to disturb it.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                        success: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'After some time working at it the heavy padlock on the chest gives a satisfying “click”. Before you can investigate the contents, however the chest springs open on its own. You leap backwards just in time to avoid the grasp of a mimic’s tendrils.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                        failure: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'You pick and pick at the lock but your patience yields before it does. Eventually you are forced to concede and walk away empty handed.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                        criticalFailure: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'You insert your tools into the lock only to have them snap the moment you apply pressure. In frustration you kick the chest in anger. To your shock, and initial delight, the chest springs open… to reveal a mass of thrashing tentacles.',\r\n                                'The mimic coils around you in a flash, ensnaring all your limbs before you can back away. You are slowly dragged towards the mimic.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                    },\r\n                },\r\n                {\r\n                    type: ChoiceType.ROLL,\r\n                    description: 'Check the chest for traps',\r\n                    requirements: { [Stat.WIS]: 1 },\r\n                    dc: 18,\r\n                    outcomes: {\r\n                        criticalSuccess: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'Careful observation combined with long years of experience tells you one thing: this is a mimic. Only a fool would try to open one carelessly. You should either prepare to deal with it or walk away now.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                        success: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'Carefully studying the chest you notice a few things amiss. It is positioned conspicuously - something you wouldn’t expect when storing valuables. It is also noticeably less dusty than the surrounding, suggesting that it was moved here recently. You have no firm proof, but you definitely suspect a trap.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                        failure: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: ['You don’t notice anything out of the ordinary.'],\r\n                            continueText: 'Continue',\r\n                        },\r\n                        criticalFailure: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'While your attention is focused on the chest something else focuses its attention on you...',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                    },\r\n                },\r\n                {\r\n                    type: ChoiceType.ROLL,\r\n                    description: 'Open the chest using magic',\r\n                    requirements: { [Stat.INT]: 6 },\r\n                    dc: 18,\r\n                    outcomes: {\r\n                        criticalSuccess: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'The valuable items from the chest teleport directly to you. Oddly some of them seem to be coated in digestive fluid. It seems you looted not only the chest but the stomach contents of its occupying mimic. Good thing you were precise with your incantation.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                        success: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'The contents of the chest teleport directly to you. Unfortunately this includes a dormant mimic. You can try to fight it or back away now.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                        failure: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: ['Your spell fizzles. Magic is hard.'],\r\n                            continueText: 'Continue',\r\n                        },\r\n                        criticalFailure: {\r\n                            type: OutcomeType.END_ENCOUNTER,\r\n                            text: [\r\n                                'Your magic runs amok. Instead of teleporting the contents of the chest directly to you, you find yourself teleported to them! Worse, this chest appears to have been the hiding spot for a mimic. You are trapped in a locked chest surrounded by tentacles.',\r\n                            ],\r\n                            continueText: 'Continue',\r\n                        },\r\n                    },\r\n                },\r\n                {\r\n                    type: ChoiceType.END_ENCOUNTER,\r\n                    description: 'Ignore the chest',\r\n                    text: ['You ignore the chest and move on'],\r\n                    continueText: 'Continue',\r\n                },\r\n            ],\r\n        },\r\n        {\r\n            id: '622df858-e07b-4b26-8237-6d755ffb368c',\r\n            type: EncounterStageType.CHOICE,\r\n            text: ['You attempt to fight the mimic!'],\r\n            choices: [],\r\n        },\r\n    ],\r\n};\r\n","import React, { Component, ReactElement } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { noop } from '../common/functions';\r\nimport { encounterRegister } from '../common/redux/encounter/encounterActions';\r\nimport './CombatSandbox1.scss';\r\nimport { EncounterPanel } from './components/EncounterPanel/EncounterPanel';\r\nimport { PlayerConfigPanel } from './components/PlayerConfigPanel/PlayerConfigPanel';\r\nimport { encounter1 } from './encounter1';\r\nimport { Scene } from './enums';\r\nimport { Player } from './Player';\r\nimport { setScene } from './redux/actions/game-actions';\r\nimport { setPlayer } from './redux/actions/player-actions';\r\nimport { defaultPlayer } from './redux/reducers/player-reducer';\r\nimport { State } from './redux/store';\r\n\r\nexport interface CombatSandbox1Props {\r\n    player: Player;\r\n    load: () => void;\r\n}\r\n\r\nexport class CombatSandbox1 extends Component<CombatSandbox1Props> {\r\n    public static defaultProps?: Pick<CombatSandbox1Props, any> = {\r\n        load: noop,\r\n    };\r\n\r\n    public constructor(props: CombatSandbox1Props) {\r\n        super(props);\r\n        props.load();\r\n    }\r\n\r\n    public render(): ReactElement {\r\n        return (\r\n            <div className=\"CombatSandbox1\">\r\n                <div className=\"config-panel\">\r\n                    <div className=\"panel-header\">\r\n                        <h2>Configuration</h2>\r\n                    </div>\r\n                    <PlayerConfigPanel />\r\n                </div>\r\n                <div className=\"encounter-panel\">\r\n                    <div className=\"panel-header\">\r\n                        <h2>Encounter</h2>\r\n                    </div>\r\n                    <EncounterPanel />\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state: State): Partial<CombatSandbox1Props> {\r\n    return {\r\n        player: state.player,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch): Partial<CombatSandbox1Props> {\r\n    return {\r\n        load(): void {\r\n            dispatch(encounterRegister(encounter1));\r\n            dispatch(setPlayer(defaultPlayer()));\r\n            dispatch(setScene(Scene.ENCOUNTER_SELECT));\r\n        },\r\n    };\r\n}\r\n\r\nexport const ConnectedCombatSandbox1 = connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(CombatSandbox1 as any);\r\n","import { Action, Reducer } from 'redux';\r\nimport { Player } from '../../../combat-sandbox-1/Player';\r\nimport { PayloadAction } from '../../../combat-sandbox-1/redux/redux-utils';\r\nimport { getRequiredStats } from '../../encounter/encounterUtils';\r\nimport {\r\n    ActiveEncounter,\r\n    RollOutcomeType,\r\n    RollState,\r\n    StageState,\r\n} from '../../model/encounter/ActiveEncounter';\r\nimport { Encounter } from '../../model/encounter/Encounter';\r\nimport {\r\n    ChoiceType,\r\n    EncounterChoice,\r\n    instanceofRollChoice,\r\n} from '../../model/encounter/EncounterChoice';\r\nimport { EncounterOutcome } from '../../model/encounter/EncounterOutcome';\r\nimport { instanceOfChoicesStage } from '../../model/encounter/EncounterStage';\r\nimport { EncounterAction, EncounterRollDef } from './encounterActions';\r\n\r\nfunction defaultActiveEncounter(): ActiveEncounter {\r\n    return { encounter: null, stage: null, stageState: null };\r\n}\r\n\r\nconst reducers: Record<string, Reducer<ActiveEncounter>> = {\r\n    [EncounterAction.START]: encounterStartReducer,\r\n    [EncounterAction.RESET]: encounterResetReducer,\r\n    [EncounterAction.SELECT_CHOICE]: encounterSelectChoiceReducer,\r\n    [EncounterAction.SET_STAGE_STATE]: encounterSetStageStateReducer,\r\n    [EncounterAction.ROLL]: encounterRollReducer,\r\n    [EncounterAction.ROLL_CONTINUE]: encounterRollContinueReducer,\r\n    [EncounterAction.SET_STAGE]: setStageReducer,\r\n};\r\n\r\nexport function activeEncounterReducer(\r\n    state: ActiveEncounter = defaultActiveEncounter(),\r\n    action: Action\r\n): ActiveEncounter {\r\n    const reducer = reducers[action.type];\r\n    return reducer ? reducer(state, action) : state;\r\n}\r\n\r\nfunction encounterStartReducer(\r\n    state: ActiveEncounter,\r\n    action: PayloadAction<Encounter>\r\n): ActiveEncounter {\r\n    const encounter = action.payload;\r\n    if (encounter) {\r\n        const stage = encounter.stages.find((s) => s.id === encounter.entryStage);\r\n        if (stage) {\r\n            return { encounter, stage, stageState: StageState.INIT };\r\n        }\r\n    }\r\n    return state;\r\n}\r\n\r\nfunction encounterResetReducer(): ActiveEncounter {\r\n    return defaultActiveEncounter();\r\n}\r\n\r\nfunction encounterSelectChoiceReducer(\r\n    state: ActiveEncounter,\r\n    { payload }: PayloadAction<EncounterChoice>\r\n): ActiveEncounter {\r\n    if (\r\n        state.stageState !== StageState.INIT ||\r\n        !payload ||\r\n        !instanceOfChoicesStage(state.stage) ||\r\n        !state.stage.choices.includes(payload)\r\n    ) {\r\n        return state;\r\n    }\r\n    const newState = { ...state, stageState: StageState.PICKED, choice: payload };\r\n    if (payload.type === ChoiceType.ROLL) {\r\n        newState.rollState = RollState.INIT;\r\n    }\r\n    return newState;\r\n}\r\n\r\nfunction encounterSetStageStateReducer(\r\n    state: ActiveEncounter,\r\n    { payload }: PayloadAction<StageState>\r\n): ActiveEncounter {\r\n    if (payload !== state.stageState) {\r\n        return { ...state, stageState: payload };\r\n    }\r\n    return state;\r\n}\r\n\r\nfunction encounterRollReducer(\r\n    state: ActiveEncounter,\r\n    { payload }: PayloadAction<EncounterRollDef>\r\n): ActiveEncounter {\r\n    if (payload) {\r\n        const rolls = state.rolls ?? [];\r\n        rolls.push(payload.roll);\r\n        return { ...state, rolls };\r\n    }\r\n    return state;\r\n}\r\n\r\nfunction encounterRollContinueReducer(\r\n    state: ActiveEncounter,\r\n    action: PayloadAction<Player>\r\n): ActiveEncounter {\r\n    const { rolls, choice } = state;\r\n    if (!instanceofRollChoice(choice)) return state;\r\n\r\n    const player = action.payload;\r\n    const { dc, outcomes } = choice;\r\n    const stats = getRequiredStats(choice);\r\n    const statSum = stats.reduce((sum, stat) => sum + player[stat], 0);\r\n    const rollSum = rolls.reduce((sum, roll) => sum + roll, 0);\r\n    const total = statSum + rollSum;\r\n    let rollOutcome: EncounterOutcome;\r\n    let rollOutcomeType: RollOutcomeType;\r\n    if (rolls.includes(20) || total >= dc + 10) {\r\n        rollOutcome = outcomes.criticalSuccess ?? outcomes.success;\r\n        rollOutcomeType = outcomes.criticalSuccess\r\n            ? RollOutcomeType.CRITICAL_SUCCESS\r\n            : RollOutcomeType.SUCCESS;\r\n    } else if (total < 7) {\r\n        rollOutcome = outcomes.criticalFailure ?? outcomes.failure;\r\n        rollOutcomeType = outcomes.criticalFailure\r\n            ? RollOutcomeType.CRITICAL_FAILURE\r\n            : RollOutcomeType.FAILURE;\r\n    } else if (total >= dc) {\r\n        rollOutcome = outcomes.success;\r\n        rollOutcomeType = RollOutcomeType.SUCCESS;\r\n    } else {\r\n        rollOutcome = outcomes.failure;\r\n        rollOutcomeType = RollOutcomeType.FAILURE;\r\n    }\r\n    return {\r\n        ...state,\r\n        rollState: RollState.ROLLED,\r\n        rollTotal: total,\r\n        rollOutcome,\r\n        rollOutcomeType,\r\n    };\r\n}\r\n\r\nfunction setStageReducer(\r\n    state: ActiveEncounter,\r\n    { payload }: PayloadAction<string>\r\n): ActiveEncounter {\r\n    if (typeof payload !== 'string' || payload === state.stage.id) {\r\n        return state;\r\n    }\r\n    const newStage = state.encounter.stages.find((stage) => stage.id === payload);\r\n    if (!newStage) {\r\n        return state;\r\n    }\r\n    return {\r\n        ...state,\r\n        stage: newStage,\r\n        stageState: StageState.INIT,\r\n        rolls: [],\r\n        rollState: null,\r\n        rollOutcome: null,\r\n        rollOutcomeType: null,\r\n        rollTotal: 0,\r\n    };\r\n}\r\n","import { Action, Reducer } from 'redux';\nimport { PayloadAction } from '../../../combat-sandbox-1/redux/redux-utils';\nimport { Encounter } from '../../model/encounter/Encounter';\nimport { EncounterAction } from './encounterActions';\n\nconst reducers: Record<string, Reducer<Record<string, Encounter>>> = {\n    [EncounterAction.REGISTER]: encounterRegisterReducer,\n};\n\nexport function encounterByIdReducer(\n    state: Record<string, Encounter> = {},\n    action: Action\n): Record<string, Encounter> {\n    const reducer = reducers[action.type];\n    return reducer ? reducer(state, action) : state;\n}\n\nfunction encounterRegisterReducer(\n    state: Record<string, Encounter>,\n    action: PayloadAction<Encounter>\n): Record<string, Encounter> {\n    const encounter = action.payload;\n\n    if (!encounter) {\n        return state;\n    }\n\n    if (state[encounter.id]) {\n        console.warn(`Duplicate encounter ID registered: ${encounter.id}`);\n    }\n\n    return { ...state, [encounter.id]: encounter };\n}\n","import { combineReducers } from 'redux';\nimport { activeEncounterReducer } from './activeEncounterReducer';\nimport { encounterByIdReducer } from './encounterByIdReducer';\nimport { EncounterState } from './encounterState';\n\nexport const encounterReducer = combineReducers<EncounterState>({\n    byId: encounterByIdReducer,\n    active: activeEncounterReducer,\n});\n","import { Action, Reducer } from 'redux';\nimport { Scene } from '../../enums';\nimport { GameActions } from '../actions/game-actions';\nimport { PayloadAction } from '../redux-utils';\n\nconst reducers: Record<string, Reducer<Scene>> = {\n    [GameActions.SET_SCENE]: setSceneReducer,\n};\n\nexport function currentSceneReducer(currentScene = Scene.ENCOUNTER_SELECT, action: Action): Scene {\n    const reducer = reducers[action.type];\n    return reducer ? reducer(currentScene, action) : currentScene;\n}\n\nfunction setSceneReducer(currentScene: Scene, { payload }: PayloadAction<Scene>): Scene {\n    return payload;\n}\n","import { combineReducers } from 'redux';\nimport { encounterReducer } from '../../common/redux/encounter/encounterReducer';\nimport { currentSceneReducer } from './reducers/current-scene-reducer';\nimport { playerReducer } from './reducers/player-reducer';\nimport { State } from './store';\n\nexport const rootReducer = combineReducers<State>({\n    player: playerReducer,\n    encounter: encounterReducer,\n    currentScene: currentSceneReducer,\n});\n","import { createStore } from 'redux';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\nimport { EncounterState } from '../../common/redux/encounter/encounterState';\r\nimport { Scene } from '../enums';\r\nimport { ActiveEncounter } from '../model/ActiveEncounter';\r\nimport { Encounter } from '../model/Encounter';\r\nimport { Player } from '../Player';\r\nimport { rootReducer } from './root-reducer';\r\n\r\nexport interface OldEncounterState {\r\n    all: Record<string, Encounter>;\r\n    active: ActiveEncounter;\r\n}\r\n\r\nexport interface State {\r\n    player: Player;\r\n    currentScene: Scene;\r\n    encounter: EncounterState;\r\n}\r\n\r\nexport const store = createStore(rootReducer, composeWithDevTools());\r\n","import React from 'react';\r\nimport { render } from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport { ConnectedCombatSandbox1 } from './combat-sandbox-1/CombatSandbox1';\r\nimport { store } from './combat-sandbox-1/redux/store';\r\nimport './index.scss';\r\n\r\nconst appRoot = document.getElementById('app-root');\r\n\r\nrender(\r\n    <Provider store={store}>\r\n        <ConnectedCombatSandbox1 />\r\n    </Provider>,\r\n    appRoot\r\n);\r\n"],"sourceRoot":""}